{% extends "admin/admin_base.html" %}
{% block content %}
  <h2>Manage Articles</h2>
  <table class="table">
    <thead>
      <tr>
        <th>Title</th>
        <th>Date</th>
        <th>Tags</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for article in articles %}
      <tr class="admin-row">
        <td class="admin-name">{{ article.title }}</td>
        <td>
          {% if article.timestamp %}
            {{ article.timestamp.strftime('%Y-%m-%d') }}
          {% else %}
            (No date)
          {% endif %}
        </td>
        <td>
          {% if article.tags %}
            {{ article.tags | map(attribute='name') | join(', ') }}
          {% else %}
            <em>No tags</em>
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('article.admin_edit_article', id=article.id) }}" class="btn btn-sm btn-orange me-2">Edit</a>
          <form method="POST" action="{{ url_for('article.admin_delete_article', id=article.id) }}" style="display:inline;">
            <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Delete this article?');">Delete</button>
          </form>
          <form method="POST" action="{{ url_for('article.admin_add_tag_to_article', article_id=article.id) }}">
            <input type="text" name="new_tags" class="form-control form-control-sm d-inline-block" style="width:120px;" placeholder="tag1, tag2">
            <button type="submit" class="btn btn-sm btn-secondary ms-2">Add Tags</button>
          </form>
          <a href="{{ url_for('article.admin_link_images_to_article', article_id=article.id) }}" class="btn btn-sm btn-secondary ms-2">Link Images</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}